<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ENIM CUP â€“ Tournoi Ramadan 2025</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš½</text></svg>" />
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- â–‘â–‘ LOADER â–‘â–‘ -->
  <div id="loader">
    <div class="loader-inner">
      <div class="loader-logo">ENIM <span>CUP</span></div>
      <div class="loader-bar"><div class="loader-fill"></div></div>
      <p>Connexion Ã  la base de donnÃ©esâ€¦</p>
    </div>
  </div>

  <!-- â–‘â–‘ NAV â–‘â–‘ -->
  <nav id="mainNav">
    <div class="nav-left">
      <div class="nav-logo">ENIM <span>CUP</span></div>
    </div>
    <div class="nav-links" id="navLinks">
      <button onclick="showPage('home')"        data-page="home"       class="active">Accueil</button>
      <button onclick="showPage('classement')"  data-page="classement">Classement</button>
      <button onclick="showPage('equipes')"     data-page="equipes">Ã‰quipes</button>
      <button onclick="showPage('matchs')"      data-page="matchs">Matchs</button>
      <button onclick="showPage('stats')"       data-page="stats">Statistiques</button>
      <button onclick="showPage('admin')"       data-page="admin" class="nav-admin">âš™ Admin</button>
    </div>
    <button class="nav-burger" id="navBurger" onclick="toggleMobileMenu()">â˜°</button>
  </nav>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <button onclick="showPage('home');toggleMobileMenu()"       data-page="home"       class="active">ğŸ  Accueil</button>
    <button onclick="showPage('classement');toggleMobileMenu()" data-page="classement">ğŸ† Classement</button>
    <button onclick="showPage('equipes');toggleMobileMenu()"    data-page="equipes">ğŸ‘¥ Ã‰quipes</button>
    <button onclick="showPage('matchs');toggleMobileMenu()"     data-page="matchs">âš½ Matchs</button>
    <button onclick="showPage('stats');toggleMobileMenu()"      data-page="stats">ğŸ“Š Statistiques</button>
    <button onclick="showPage('admin');toggleMobileMenu()"      data-page="admin" class="nav-admin">âš™ Admin</button>
  </div>

  <!-- â–‘â–‘ PAGES WRAPPER â–‘â–‘ -->
  <main id="mainContent">

    <!-- â”€â”€ HOME â”€â”€ -->
    <section class="page active" id="page-home">
      <div class="hero">
        <div class="hero-glow"></div>
        <div class="hero-badge">ğŸŒ™ Ramadan 1446H Â· ENIM Rabat</div>
        <h1 class="hero-title">ENIM <span>CUP</span></h1>
        <h2 class="hero-sub">Tournoi de Football Ramadan 2025</h2>
        <p class="hero-desc">L'Ã‰cole Nationale de l'Industrie MinÃ©rale prÃ©sente son tournoi inter-filiÃ¨res du mois sacrÃ© de Ramadan.</p>
        <div class="hero-stats" id="heroStats">
          <div class="hero-stat"><div class="hs-num" id="hs-equipes">â€“</div><div class="hs-label">Ã‰quipes</div></div>
          <div class="hero-stat"><div class="hs-num" id="hs-joueurs">â€“</div><div class="hs-label">Joueurs</div></div>
          <div class="hero-stat"><div class="hs-num" id="hs-matchs">â€“</div><div class="hs-label">Matchs jouÃ©s</div></div>
          <div class="hero-stat"><div class="hs-num" id="hs-buts">â€“</div><div class="hs-label">Buts</div></div>
          <div class="hero-stat"><div class="hs-num" id="hs-leader">â€“</div><div class="hs-label">Leader</div></div>
        </div>
      </div>

      <div class="home-next">
        <div class="section-label">â± Prochain match</div>
        <div id="nextMatch" class="next-match-card">Chargementâ€¦</div>
      </div>
    </section>

    <!-- â”€â”€ CLASSEMENT â”€â”€ -->
    <section class="page" id="page-classement">
      <div class="page-header">
        <h2 class="page-title">ğŸ† <span>Classement</span></h2>
        <p class="page-sub">Mis Ã  jour automatiquement en temps rÃ©el</p>
      </div>
      <div class="table-wrap">
        <table id="classementTable">
          <thead>
            <tr>
              <th>#</th><th>Ã‰quipe</th><th title="Matchs jouÃ©s">J</th>
              <th title="Victoires">V</th><th title="Nuls">N</th><th title="DÃ©faites">D</th>
              <th title="Buts pour">BP</th><th title="Buts contre">BC</th>
              <th title="DiffÃ©rence de buts">+/-</th><th title="Points">Pts</th>
              <th>Forme</th>
            </tr>
          </thead>
          <tbody id="classementBody"><tr><td colspan="11" class="loading-cell">Chargementâ€¦</td></tr></tbody>
        </table>
      </div>
    </section>

    <!-- â”€â”€ Ã‰QUIPES â”€â”€ -->
    <section class="page" id="page-equipes">
      <div class="page-header">
        <h2 class="page-title">ğŸ‘¥ <span>Ã‰quipes</span></h2>
        <p class="page-sub">Cliquez sur une Ã©quipe pour voir ses joueurs</p>
      </div>
      <div class="teams-grid" id="teamsGrid"><div class="loading-cell">Chargementâ€¦</div></div>
    </section>

    <!-- â”€â”€ MATCHS â”€â”€ -->
    <section class="page" id="page-matchs">
      <div class="page-header">
        <h2 class="page-title">âš½ <span>Matchs</span></h2>
        <p class="page-sub">RÃ©sultats et programme</p>
      </div>
      <div id="matchsList"><div class="loading-cell">Chargementâ€¦</div></div>
    </section>

    <!-- â”€â”€ STATS â”€â”€ -->
    <section class="page" id="page-stats">
      <div class="page-header">
        <h2 class="page-title">ğŸ“Š <span>Statistiques</span></h2>
        <p class="page-sub">Buteurs, cartons et donnÃ©es globales</p>
      </div>
      <div class="stats-cards" id="statsCards"></div>
      <h3 class="sub-title">âš½ Classement des Buteurs</h3>
      <div class="table-wrap" style="margin-bottom:2rem">
        <table>
          <thead><tr><th>#</th><th>Joueur</th><th>Ã‰quipe</th><th>Buts</th><th>ğŸŸ¨</th><th>ğŸŸ¥</th></tr></thead>
          <tbody id="scorersBody"><tr><td colspan="6" class="loading-cell">Chargementâ€¦</td></tr></tbody>
        </table>
      </div>
      <h3 class="sub-title">ğŸŸ¨ Cartons</h3>
      <div class="table-wrap">
        <table>
          <thead><tr><th>Joueur</th><th>Ã‰quipe</th><th>Type</th><th>Match</th><th>Minute</th></tr></thead>
          <tbody id="cartonsBody"><tr><td colspan="5" class="loading-cell">Chargementâ€¦</td></tr></tbody>
        </table>
      </div>
    </section>

    <!-- â”€â”€ ADMIN â”€â”€ -->
    <section class="page" id="page-admin">

      <!-- LOGIN -->
      <div id="adminLogin" class="login-wrap">
        <div class="login-card">
          <div class="login-icon">ğŸ”</div>
          <h2>Espace Admin</h2>
          <p>AccÃ¨s rÃ©servÃ© aux organisateurs</p>
          <div id="loginMsg"></div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="loginEmail" placeholder="admin@enim.ma" />
          </div>
          <div class="form-group">
            <label>Mot de passe</label>
            <input type="password" id="loginPass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
          </div>
          <button class="btn btn-primary btn-full" onclick="doLogin()">Se connecter</button>
        </div>
      </div>

      <!-- DASHBOARD -->
      <div id="adminDash" style="display:none">
        <div class="dash-header">
          <div>
            <h2 class="page-title">âš™ <span>Tableau de Bord</span></h2>
            <p class="page-sub" id="dashUser"></p>
          </div>
          <div style="display:flex;gap:.5rem;flex-wrap:wrap">
            <button class="btn btn-outline btn-sm" onclick="showPage('admin');changePass()">ğŸ”‘ Changer mot de passe</button>
            <button class="btn btn-danger btn-sm" onclick="doLogout()">DÃ©connexion</button>
          </div>
        </div>

        <!-- Admin Tabs -->
        <div class="admin-tabs">
          <button class="active" onclick="adminTab(this,'tab-equipes')">ğŸ‘¥ Ã‰quipes</button>
          <button onclick="adminTab(this,'tab-joueurs')">ğŸ½ Joueurs</button>
          <button onclick="adminTab(this,'tab-matchs')">âš½ Matchs</button>
          <button onclick="adminTab(this,'tab-cartons')">ğŸŸ¨ Cartons</button>
          <button onclick="adminTab(this,'tab-settings')">âš™ ParamÃ¨tres</button>
        </div>

        <!-- TAB: Ã‰QUIPES -->
        <div class="admin-tab active" id="tab-equipes">
          <div class="admin-card">
            <h3>Ajouter une Ã©quipe</h3>
            <div class="form-row">
              <div class="form-group"><label>Nom de l'Ã©quipe *</label><input id="eq-nom" placeholder="Ex: GC Informatique" /></div>
              <div class="form-group"><label>Emoji</label><input id="eq-emoji" placeholder="ğŸ’»" maxlength="2" /></div>
            </div>
            <div class="form-group"><label>Coach / Responsable</label><input id="eq-coach" placeholder="Nom du responsable" /></div>
            <div id="eqMsg"></div>
            <button class="btn btn-primary" onclick="addEquipe()">+ Ajouter l'Ã©quipe</button>
          </div>
          <div class="admin-card">
            <h3>Ã‰quipes enregistrÃ©es</h3>
            <div id="adminEquipesList"><div class="loading-cell">Chargementâ€¦</div></div>
          </div>
        </div>

        <!-- TAB: JOUEURS -->
        <div class="admin-tab" id="tab-joueurs">
          <div class="admin-card">
            <h3>Ajouter un joueur</h3>
            <div class="form-row">
              <div class="form-group"><label>Nom complet *</label><input id="j-nom" placeholder="Ex: Mohammed Alami" /></div>
              <div class="form-group"><label>NumÃ©ro</label><input id="j-num" type="number" placeholder="10" min="1" max="99" /></div>
            </div>
            <div class="form-row">
              <div class="form-group"><label>Ã‰quipe *</label>
                <select id="j-equipe"><option value="">â€” Choisir une Ã©quipe â€”</option></select>
              </div>
              <div class="form-group"><label>Poste</label>
                <select id="j-poste">
                  <option>Gardien</option><option>DÃ©fenseur</option><option>Milieu</option><option>Attaquant</option>
                </select>
              </div>
            </div>
            <div id="jMsg"></div>
            <button class="btn btn-primary" onclick="addJoueur()">+ Ajouter le joueur</button>
          </div>
          <div class="admin-card">
            <h3>Joueurs enregistrÃ©s</h3>
            <div id="adminJoueursList"><div class="loading-cell">Chargementâ€¦</div></div>
          </div>
        </div>

        <!-- TAB: MATCHS -->
        <div class="admin-tab" id="tab-matchs">
          <div class="admin-card">
            <h3>Programmer / Enregistrer un match</h3>
            <div class="form-row">
              <div class="form-group"><label>Ã‰quipe Domicile *</label>
                <select id="m-home"><option value="">â€” Domicile â€”</option></select>
              </div>
              <div class="form-group"><label>Ã‰quipe ExtÃ©rieur *</label>
                <select id="m-away"><option value="">â€” ExtÃ©rieur â€”</option></select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group"><label>Date & Heure</label><input id="m-date" type="datetime-local" /></div>
              <div class="form-group"><label>Phase / JournÃ©e</label><input id="m-journee" placeholder="Ex: JournÃ©e 1, Demi-finaleâ€¦" /></div>
            </div>
            <div class="form-row">
              <div class="form-group"><label>Score Domicile</label><input id="m-sh" type="number" min="0" placeholder="0" /></div>
              <div class="form-group"><label>Score ExtÃ©rieur</label><input id="m-sa" type="number" min="0" placeholder="0" /></div>
            </div>
            <small class="hint">Laissez les scores vides pour programmer un match Ã  venir.</small>
            <div id="mMsg"></div>
            <button class="btn btn-primary" onclick="addMatch()">+ Enregistrer le match</button>
          </div>
          <div class="admin-card">
            <h3>Liste des matchs</h3>
            <div id="adminMatchsList"><div class="loading-cell">Chargementâ€¦</div></div>
          </div>
        </div>

        <!-- TAB: CARTONS -->
        <div class="admin-tab" id="tab-cartons">
          <div class="admin-card">
            <h3>Ajouter un carton</h3>
            <div class="form-row">
              <div class="form-group"><label>Joueur *</label>
                <select id="c-joueur"><option value="">â€” Choisir un joueur â€”</option></select>
              </div>
              <div class="form-group"><label>Match *</label>
                <select id="c-match"><option value="">â€” Choisir un match â€”</option></select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group"><label>Type de carton</label>
                <select id="c-type">
                  <option value="jaune">ğŸŸ¨ Carton Jaune</option>
                  <option value="rouge">ğŸŸ¥ Carton Rouge</option>
                </select>
              </div>
              <div class="form-group"><label>Minute</label><input id="c-minute" type="number" min="1" max="120" placeholder="45" /></div>
            </div>
            <div id="cMsg"></div>
            <button class="btn btn-primary" onclick="addCarton()">+ Ajouter le carton</button>
          </div>
          <div class="admin-card">
            <h3>Cartons enregistrÃ©s</h3>
            <div id="adminCartonsList"><div class="loading-cell">Chargementâ€¦</div></div>
          </div>
        </div>

        <!-- TAB: SETTINGS -->
        <div class="admin-tab" id="tab-settings">
          <div class="admin-card">
            <h3>ğŸ”‘ Changer le mot de passe admin</h3>
            <div class="form-group"><label>Mot de passe actuel</label><input type="password" id="cp-old" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" /></div>
            <div class="form-group"><label>Nouveau mot de passe</label><input type="password" id="cp-new" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" /></div>
            <div class="form-group"><label>Confirmer</label><input type="password" id="cp-confirm" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" /></div>
            <div id="cpMsg"></div>
            <button class="btn btn-primary" onclick="changePass()">Mettre Ã  jour</button>
          </div>
          <div class="admin-card">
            <h3>ğŸ“§ Changer l'email admin</h3>
            <div class="form-group"><label>Nouvel email</label><input type="email" id="ce-email" placeholder="admin@enim.ma" /></div>
            <div class="form-group"><label>Mot de passe actuel (confirmation)</label><input type="password" id="ce-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" /></div>
            <div id="ceMsg"></div>
            <button class="btn btn-primary" onclick="changeEmail()">Mettre Ã  jour</button>
          </div>
          <div class="admin-card" style="border-color:rgba(255,60,60,0.2)">
            <h3 style="color:#ff6b6b">âš  Zone dangereuse</h3>
            <p style="color:var(--muted);font-size:.85rem;margin-bottom:1rem">Ces actions sont irrÃ©versibles.</p>
            <button class="btn btn-danger" onclick="resetAllData()">ğŸ—‘ RÃ©initialiser toutes les donnÃ©es</button>
          </div>
        </div>

      </div><!-- /adminDash -->
    </section>

  </main><!-- /mainContent -->

  <!-- â–‘â–‘ MODAL Ã‰QUIPE â–‘â–‘ -->
  <div class="modal-overlay" id="teamModal" onclick="if(event.target===this)closeModal('teamModal')">
    <div class="modal">
      <div class="modal-head">
        <div class="modal-title" id="modalTeamTitle"></div>
        <button class="modal-close" onclick="closeModal('teamModal')">âœ•</button>
      </div>
      <div id="modalTeamBody"></div>
    </div>
  </div>

  <!-- â–‘â–‘ TOAST â–‘â–‘ -->
  <div id="toast"></div>

  <!-- Firebase SDK -->
  <script type="module" src="app.js"></script>
</body>
</html>
